Sub AddSideColumnOnAllPages()
    Dim shp As Shape
    Dim colWidth As Single
    Dim leftMargin As Single
    Dim topMargin As Single
    Dim bottomMargin As Single
    Dim pageHeight As Single
    Dim totalPages As Long
    Dim currentPage As Long

    colWidth = CentimetersToPoints(4)
    leftMargin = ActiveDocument.PageSetup.leftMargin
    topMargin = ActiveDocument.PageSetup.topMargin
    bottomMargin = ActiveDocument.PageSetup.bottomMargin
    pageHeight = ActiveDocument.PageSetup.pageHeight
    totalPages = ActiveDocument.ComputeStatistics(wdStatisticPages)

    For currentPage = 1 To totalPages
        Selection.GoTo What:=wdGoToPage, Which:=wdGoToAbsolute, Count:=currentPage
        Selection.Collapse Direction:=wdCollapseStart

        Set shp = ActiveDocument.Shapes.AddTextbox(msoTextOrientationHorizontal, _
            leftMargin - colWidth - CentimetersToPoints(0.2), _
            topMargin, colWidth, _
            pageHeight - topMargin - bottomMargin, Selection.Range)

        With shp
            .Line.Visible = msoFalse
            .Fill.Solid
            .Fill.BackColor.RGB = RGB(255, 255, 255)
            .Fill.Transparency = 1
            .TextFrame.TextRange.Text = ""
            .TextFrame.MarginLeft = 5
            .TextFrame.MarginRight = 5
            .TextFrame.MarginTop = 5
            .TextFrame.MarginBottom = 5
            .WrapFormat.Type = wdWrapBehind
            .RelativeHorizontalPosition = wdRelativeHorizontalPositionMargin
            .RelativeVerticalPosition = wdRelativeVerticalPositionPage
            .LockAnchor = True
            .LockAspectRatio = msoTrue
            .TextFrame.AutoSize = False
        End With
    Next currentPage

    MsgBox "Side columns added to all pages!"
End Sub
